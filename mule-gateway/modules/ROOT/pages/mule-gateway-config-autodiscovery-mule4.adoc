= Configuring Mule Gateway API Autodiscovery in a Mule 4 Application
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]
:page-aliases: api-manager::configure-autodiscovery-4-task.adoc, api-manager::api-auto-discovery-new-reference.adoc

To configure API Autodiscovery in your Mule 4.x application:

. <<req-api-in-apim>>
. <<req-api-manager-config>>
. <<anypoint-platform-credentials>>
. <<autodiscovery-config>>


[[req-api-in-apim]]
== Make your API Available in API Manager

include::mule-gateway::partial$autodiscovery-mule4.adoc[tags="req-api-in-api-manager"]

[[req-api-manager-config]]
== Add Your API Specification to API Manager

include::mule-gateway::partial$autodiscovery-mule4.adoc[tags="req-api-manager-config"]

[[anypoint-platform-credentials]]
== Configure Anypoint Platform Organization Credentials in Mule Runtime

include::mule-gateway::partial$autodiscovery-mule4.adoc[tags="req-anypoint-platform-credentials"]

[[configure-autodiscovery]]
== Configure Autodiscovery in a Mule Application

Configure autodiscovery directly through the application XML or through the UI:

* <<autodiscovery-config-xml>>
* <<autodiscovery-config-studio-ui>>
//* <<autodiscovery-config-acb-ui>>

[[autodiscovery-config-xml]]
=== Configuring the Autodiscovery Element in Your Mule Application

include::mule-gateway::partial$autodiscovery-mule4.adoc[tags="autodiscovery-config-xml"]

[[autodiscovery-config-studio-ui]]
=== Configuring Autodiscovery in the Studio UI

To configure autodiscovery from the Anypoint Studio UI instead of the XML code:

. In your existing flow, select the Global Elements tab in your Mule Configuration File editor.
. Click the Create button, and look for the API Autodiscovery global element.
+
image::auto-discovery-studio-7.png[align=center]
. Set the API ID and Flow Reference. +
+
image::auto-discovery-api-config.png[align=center]
+
You can also choose to use the `${apiId}` value and reference it from a `config.properties` file.

After the element is defined in the application, and the runtime is configured  with your Anypoint Platform credentials, Mule Runtime will automatically track and keep up to date with the API configuration. defined in API Manager.
//_COMBAK: Does this need to be deployed for the green dot to show in API Manager?

//
//
// FUTURE 
// === Configuring Autodiscovery from Anypoint Code Builder
//
// include::mule-gateway::partial$autodiscovery-mule4.adoc[tags="autodiscovery-config-acb-ui"]
//

== Changes from Mule 3.x Configuration

API Autodiscovery element has syntactically changed from Mule 3.x but its purpose remains the same. The element in a Mule application has the following format:

[%header%autowidth.spread,cols="a,a"]
|===
^| Mule 3.x XML element ^| Mule 4.x XML element
^| <api-platform-gw:api (...)/>. ^| <api-gateway:autodiscovery (...)/>.
|===

In Mule 4, the API is identified by the API Id and a reference to a Flow where the HTTP listener is defined. Mule 4â€™s apiId replaces the apiName and apiVersion used to specify the Autodiscovery element in Mule 3.x and prior.

== See Also

* xref:api-manager::api-auto-discovery-new-concept.adoc[Reviewing Mule Gateway API Autodiscovery concepts]
